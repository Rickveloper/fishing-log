{% include 'navbar.html' %}
<!DOCTYPE html>
<html>
<head>
    <title>Catch Gallery</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body { font-family: sans-serif; background: #f0f0f0; margin: 0; }
        .container { max-width: 1100px; margin: 40px auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 12px #0001; padding: 32px; }
        h2 { text-align: center; margin-bottom: 32px; }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
        }
        .gallery-item {
            background: #fafafa;
            border-radius: 10px;
            box-shadow: 0 1px 6px #0001;
            overflow: hidden;
            cursor: pointer;
            transition: box-shadow 0.2s;
        }
        .gallery-item:hover {
            box-shadow: 0 4px 16px #0002;
        }
        .gallery-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-bottom: 1px solid #eee;
        }
        .gallery-info {
            padding: 12px 16px 10px 16px;
            font-size: 1em;
        }
        .gallery-info strong { font-size: 1.08em; }
        .back-link { display: block; margin-bottom: 24px; color: #1976d2; text-decoration: none; font-weight: 600; }
        /* Modal */
        #galleryModal { display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.85); align-items:center; justify-content:center; z-index:9999; }
        #galleryModal .modal-content { background:#fff; border-radius:12px; max-width:90vw; max-height:90vh; padding:24px; box-shadow:0 2px 24px #0005; position:relative; display:flex; flex-direction:column; align-items:center; }
        #galleryModal img { max-width:80vw; max-height:60vh; border-radius:10px; margin-bottom:18px; }
        #galleryModal .close-btn { position:absolute; top:18px; right:24px; font-size:2.2em; color:#333; cursor:pointer; }
        #galleryModal .modal-details { font-size:1.1em; text-align:center; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Catch Gallery</h2>
        {% set photos = catches | selectattr('photo') | list %}
        {% if photos|length == 0 %}
            <div style="background:#fff3cd;color:#856404;padding:18px 24px;border-radius:10px;margin-top:18px;font-size:1.15em;text-align:center;">
                No photos uploaded yet! Go catch something awesome üêü
            </div>
        {% else %}
        <div class="gallery-grid">
            {% for c in catches if c.photo %}
            <div class="gallery-item" onclick="openGalleryModal({{ loop.index0 }})">
                <img class="gallery-img" src="{{ url_for('static', filename='uploads/' ~ c.photo) }}" alt="Catch photo">
                <div class="gallery-info">
                    <strong>{{ c.species }}</strong><br>
                    {{ c.length }}" / {{ c.weight or 'N/A' }} lbs<br>
                    <span style="color:#666;">{{ c.bait }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
    <div id="galleryModal" onclick="closeGalleryModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close-btn" onclick="closeGalleryModal(event)">&times;</span>
            <img id="modalImg" src="" alt="Catch photo">
            <div class="modal-details" id="modalDetails"></div>
        </div>
    </div>
    <script>
        const catches = {{ catches|tojson }};
        function openGalleryModal(idx) {
            const c = catches.filter(c => c.photo)[idx];
            document.getElementById('modalImg').src = '/static/uploads/' + c.photo;
            document.getElementById('modalDetails').innerHTML = `
                <strong>${c.species}</strong><br>
                ${c.length}" / ${c.weight || 'N/A'} lbs<br>
                <span style='color:#666;'>${c.bait}</span><br>
                ${c.weather_data ? `<div style='margin-top:8px;'><img src='https://openweathermap.org/img/wn/${c.weather_data.weather_icon}@2x.png' style='width:32px;vertical-align:middle;'> ${c.weather_data.temperature.toFixed(1)}¬∞F, ${c.weather_data.weather_description.charAt(0).toUpperCase() + c.weather_data.weather_description.slice(1)}</div>` : ''}
                ${c.notes ? `<div style='margin-top:8px;color:#888;'>Notes: ${c.notes}</div>` : ''}
            `;
            document.getElementById('galleryModal').style.display = 'flex';
        }
        function closeGalleryModal(e) {
            document.getElementById('galleryModal').style.display = 'none';
        }
    </script>
</body>
</html> 